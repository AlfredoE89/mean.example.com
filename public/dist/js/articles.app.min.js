var articlesApp=function(){function e(e,n,t){let a=document.getElementById(e);a.addEventListener("submit",function(e){e.preventDefault();let i=new FormData(a),r=`${window.location.origin}${n}`,s=new XMLHttpRequest;s.open(t,r),s.setRequestHeader("Content-Type","application/json; charset=UTF-8");let d={};i.forEach(function(e,n){d[n]=e}),s.send(JSON.stringify(d)),s.onload=function(){!0===JSON.parse(s.response).success?window.location.href="/":document.getElementById("formMsg").style.display="block"}})}return{deleteArticle:function(e){!function(e){let n=`${window.location.origin}/api/articles/${e}`,t=new XMLHttpRequest;t.open("DELETE",n),t.setRequestHeader("Content-Type","application/json; charset=UTF-8"),t.send(),t.onload=function(){!0===JSON.parse(t.response).success?window.location.hash="#":alert("Unknown error, the article could not be deleted")}}(e)},load:function(){let n=window.location.hash.split("-");switch(n[0]){case"#create":document.getElementById("app").innerHTML='  \n              <div class="card">\n                <div class="card-header clearfix">\n                  <h2 class="h3 float-left">Create a New Article</h2>\n                  <div class="float-right">\n                    <a href="#" class="btn btn-primary">Cancel</a>\n                  </div>\n                </div>\n                <div class="card-body">\n                <form id="createUser" class="card-body">\n                    <div id="formMsg" class="alert alert-danger text-center">Your form has errors</div>\n        \n                    <div class="row">\n                      <div class="form-group col-md-6">\n                        <label for="first_name">First Name</label>\n                        <input type="text" id="first_name" name="first_name" class="form-control" required>\n                      </div>\n        \n                      <div class="form-group col-md-6">\n                        <label for="last_name">Last Name</label>\n                        <input type="text" id="last_name" name="last_name" class="form-control" required>\n                      </div>\n                    </div>\n        \n                    <div class="row">\n                      <div class="form-group col-md-6">\n                        <label for="username">Username</label>\n                        <input type="text" id="username" name="username" class="form-control" required>\n                      </div>\n        \n                      <div class="form-group col-md-6">\n                        <label for="email">Email</label>\n                        <input type="email" id="email" name="email" class="form-control" required>\n                      </div>\n                    </div>\n        \n                    <div class="text-right">\n                      <input type="submit" value="Submit" class="btn btn-lg btn-primary btn-sm-block">\n                    </div>\n                  </form>\n                </div>\n              </div>\n          ',e("createArticle","/api/articles","POST");break;case"#view":!function(e){let n=`${window.location.origin}/api/articles/${e}`,t=new XMLHttpRequest;t.open("GET",n),t.setRequestHeader("Content-Type","application/json; charset=UTF-8"),t.send(),t.onload=function(){let e=document.getElementById("app"),n=JSON.parse(t.response),a="";a=`<div class="card">\n        <div class="card-header clearfix">\n          <h2 class="h3 float-left">${n.post.title}</h2>\n          <div class="float-right">\n            <a href="#edit-${n.post._id}" class="btn btn-primary">Edit</a>\n          </div>\n        </div>\n        <div class="card-body">\n          <div class="blockquote">${n.post.body}</div>\n          <br>\n          <div>Tagged: <em>${n.post.keywords}</em></div>\n        </div>\n      </div>\n      `,e.innerHTML=a}}(n[1]);break;case"#edit":!function(n){let t=`${window.location.origin}/api/articles/${n}`,a=new XMLHttpRequest;a.open("GET",t),a.setRequestHeader("Content-Type","application/json; charset=UTF-8"),a.send(),a.onload=function(){let n=document.getElementById("app"),t=JSON.parse(a.response);var i=Date(t.post.published);console.log(i);var r=`\n        <div class="card">\n        <div class="card-header clearfix">\n          <h2 class="h3 float-left">Edit Post</h2>\n          <div class="float-right">\n            <a href="#" class="btn btn-primary">Cancel</a>\n          </div>\n        </div>\n        <div class="card-body">\n          <form id="editArticle" class="card-body">\n            <div id="formMsg" class="alert alert-danger text-center">Your form has errors</div>\n            <div class="row">\n              <div class="form-group col-md-6">\n                <label for="title">Title</label>\n                <input type="text" id="title" name="title" class="form-control" value="${t.post.title}" required>\n              </div>\n              <div class="form-group col-md-6">\n                <label for="published">Published On</label>\n                <input type="datetime-local" id="published" name="published" class="form-control" value="${i}" required>\n              </div>\n            </div>\n            <div class="row">\n              <div class="form-group col-md">\n                <label for="body">Body</label>\n                <textarea id="body" name="body" class="form-control" rows="6" required>${t.post.body}</textarea>\n              </div>\n            </div>\n            <div class="row">\n              <div class="form-group col-md-6">\n                <label for="description">Summary</label>\n                <input type="text" id="description" name="description" class="form-control" value="${t.post.description}" required>\n              </div>\n              <div class="form-group col-md-6">\n                <label for="keywords">Keywords (separated by commas)</label>\n                <input type="text" id="keywords" name="keywords" class="form-control" value="${t.post.keywords}" required>\n              </div>\n            </div>\n            <div>\n              <input type="hidden" id="_id" name="_id" class="form-control" value="${t.post._id}" required>\n            </div>\n            <div>\n              <input type="hidden" id="created" name="created" class="form-control" value="${t.post.created}" required>\n            </div>\n            <div class="text-right">\n              <input type="submit" value="Submit" class="btn btn-lg btn-primary btn-sm-block">\n            </div>\n          </form>\n        </div>\n        <div>\n          <a href="#delete-${t.post._id}" class="text-danger">Delete</a>\n        </div>\n      </div>\n`;n.innerHTML=r,e("editArticle","/api/articles","PUT")}}(n[1]);break;case"#delete":!function(e){let n=`${window.location.origin}/api/articles/${e}`,t=new XMLHttpRequest;t.open("GET",n),t.setRequestHeader("Content-Type","application/json; charset=UTF-8"),t.send(),t.onload=function(){let e=document.getElementById("app"),n=JSON.parse(t.response),a="";a=`<div class="card bg-transparent border-danger text-danger bg-danger">\n            <div class="card-header bg-transparent border-danger">\n              <h2 class="h3 text-center">You're deleting this article</h2>\n            </div>\n            <div class="card-body text-center">\n              <div>\n                Are you sure you want to delete\n                <strong>${n.post.title}</strong>\n              </div>\n              <div>Summary: <strong>${n.post.description}</strong></div>\n              <div class="text-center">\n                <br>\n                <a onclick="articlesApp.deleteArticle('${n.post._id}');" class="btn btn-lg btn-danger text-white">\n                  Yes delete ${n.post.description}\n                </a>\n              </div>\n            </div>\n          </div>`,e.innerHTML=a}}(n[1]);break;default:!function(){let e=`${window.location.origin}/api/articles`,n=new XMLHttpRequest;n.open("GET",e),n.setRequestHeader("Content-Type","application/json; charset=UTF-8"),n.send(),n.onload=function(){let e=document.getElementById("app"),t=JSON.parse(n.response).articles,a="",i="";for(let e=0;e<t.length;e++)i=i+`<tr>\n            <td>\n              <a href="#view-${t[e]._id}">${t[e].title}</a>\n            </td>\n            <td>${t[e].description}</td>\n            <td>`+(t[e].published?`${t[e].published.slice(0,19).replace("T"," ")}`:"No Publication Date Set")+"\n            </td>\n          </tr>";a=`<div class="card">\n                <div class="card-header clearfix">\n                  <h2 class="h3 float-left">Articles</h2>\n                  <div class="float-right">\n                    <a href="#create" class="btn btn-primary">New Article</a>\n                  </div>\n                </div>\n                <div class="table-responsive">\n                  <table class="table table-striped table-hover table-bordered">\n                    <thead>\n                      <tr>\n                        <td>Name</td>\n                        <td>Username</td>\n                        <td>Email</td>\n                      </tr>\n                    </thead>\n                    <tbody>${i}</tbody>\n                  </table>\n                </div>\n              </div>`,e.innerHTML=a}}()}}}}();articlesApp.load(),window.addEventListener("hashchange",function(){articlesApp.load()});